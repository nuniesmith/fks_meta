services:
  fks_meta:
    build:
      context: .
      dockerfile: Dockerfile
    image: nuniesmith/fks_meta:latest
    container_name: fks_meta
    ports:
      - "8005:8005"
    environment:
      - SERVICE_NAME=fks_meta
      - SERVICE_PORT=8005
      - RUST_LOG=info
      # MT5 Configuration (set these in .env or override)
      - MT5_TERMINAL_PATH=${MT5_TERMINAL_PATH:-}
      - MT5_DATA_PATH=${MT5_DATA_PATH:-}
      - MT5_ACCOUNT_NUMBER=${MT5_ACCOUNT_NUMBER:-}
      - MT5_PASSWORD=${MT5_PASSWORD:-}
      - MT5_SERVER=${MT5_SERVER:-}
      - MT5_SYMBOL_PREFIX=${MT5_SYMBOL_PREFIX:-}
      - MT5_TIMEOUT_MS=5000
      - MT5_RETRY_ATTEMPTS=3
      - MT5_RETRY_DELAY_MS=1000
      - MT5_TESTNET=false
    networks:
      - fks-network
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8005/health"]
      interval: 30s
      timeout: 5s
      retries: 3
      start_period: 10s

networks:
  fks-network:
    external: true

